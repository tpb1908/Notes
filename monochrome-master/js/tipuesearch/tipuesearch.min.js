function defer(e){window.jQuery?e():setTimeout(function(){defer(e)},5)}defer(function(){!function(e){e.fn.tipuesearch=function(t){var a=e.extend({contentLocation:"tipuesearch/tipuesearch_content.json",contextBuffer:60,contextLength:60,contextStart:90,debug:!1,descriptiveWords:25,highlightTerms:!0,liveContent:"*",liveDescription:"*",minimumLength:3,mode:"static",newWindow:!1,show:9,showContext:!0,showRelated:!0,showTime:!0,showTitleCount:!0,showURL:!0,wholeWords:!0},t)
return this.each(function(){function t(e){var t=location.search,a=RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||[,""],s=a[1].replace(/\+/g,"%20")
try{s=decodeURIComponent(s)}catch(i){s=unescape(s)}return s||null}function s(t,c){var h="",o=!1,l=!1,p=!0,u=0
found=[]
var _=e("#tipue_search_input").val(),g=_.toLowerCase()
g=e.trim(g),(g.match('^"')&&g.match('"$')||g.match("^'")&&g.match("'$"))&&(p=!1)
var d=g.split(" ")
if(p){g=""
for(var f=0;f<d.length;f++){for(var v=!0,w=0;w<tipuesearch_stop_words.length;w++)d[f]==tipuesearch_stop_words[w]&&(v=!1,l=!0)
v&&(g=g+" "+d[f])}g=e.trim(g),d=g.split(" ")}else g=g.substring(1,g.length-1)
if(g.length>=a.minimumLength){if(p){if(c){for(var m=g,f=0;f<d.length;f++)for(var w=0;w<tipuesearch_replace.words.length;w++)d[f]==tipuesearch_replace.words[w].word&&(g=g.replace(d[f],tipuesearch_replace.words[w].replace_with),o=!0)
d=g.split(" ")}for(var x=g,f=0;f<d.length;f++)for(var w=0;w<tipuesearch_stem.words.length;w++)d[f]==tipuesearch_stem.words[w].word&&(x=x+" "+tipuesearch_stem.words[w].stem)
d=x.split(" ")
for(var f=0;f<i.pages.length;f++){for(var b=0,L=i.pages[f].text,w=0;w<d.length&&("/"!=i.pages[f].url&&"/tags"!=i.pages[f].url);w++){if(a.wholeWords)var C=RegExp("\\b"+d[w]+"\\b","gi")
else var C=RegExp(d[w],"gi")
if(-1!=i.pages[f].title.search(C)){var R=i.pages[f].title.match(C).length
b+=20*R}if(-1!=i.pages[f].text.search(C)){var R=i.pages[f].text.match(C).length
b+=20*R}if(-1!=i.pages[f].tags.search(C)){var R=i.pages[f].tags.match(C).length
b+=10*R}if(-1!=i.pages[f].url.search(C)&&(b+=20),0!=b)for(var T=0;T<tipuesearch_weight.weight.length;T++)i.pages[f].url==tipuesearch_weight.weight[T].url&&(b+=tipuesearch_weight.weight[T].score)
d[w].match("^-")&&(C=RegExp(d[w].substring(1),"i"),(-1!=i.pages[f].title.search(C)||-1!=i.pages[f].text.search(C)||-1!=i.pages[f].tags.search(C))&&(b=0))}0!=b&&(found.push({score:b,title:i.pages[f].title,desc:L,url:i.pages[f].url}),u++)}}else for(var f=0;f<i.pages.length;f++){var b=0,L=i.pages[f].text,C=RegExp(g,"gi")
if(-1!=i.pages[f].title.search(C)){var R=i.pages[f].title.match(C).length
b+=20*R}if(-1!=i.pages[f].text.search(C)){var R=i.pages[f].text.match(C).length
b+=20*R}if(-1!=i.pages[f].tags.search(C)){var R=i.pages[f].tags.match(C).length
b+=10*R}if(-1!=i.pages[f].url.search(C)&&(b+=20),0!=b)for(var T=0;T<tipuesearch_weight.weight.length;T++)i.pages[f].url==tipuesearch_weight.weight[T].url&&(b+=tipuesearch_weight.weight[T].score)
0!=b&&(found.push({score:b,title:i.pages[f].title,desc:L,url:i.pages[f].url}),u++)}if(0!=u){if(a.showTitleCount&&0==r){var k=document.title
document.title="("+u+") "+k,r++}if(o&&(h+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+g+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+m+"</a></div>"),1==u?h+='<div id="tipue_search_results_count">'+tipuesearch_string_4:(c_c=(""+u).replace(/\B(?=(\d{3})+(?!\d))/g,","),h+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5),a.showTime){var y=(new Date).getTime(),E=(y-startTimer)/1e3
h+=" ("+E.toFixed(2)+" "+tipuesearch_string_14+")",a.showTime=!1}h+="</div>",found.sort(function(e,t){return t.score-e.score})
for(var W=0,f=0;f<found.length;f++){if(W>=t&&W<a.show+t){if(h+='<a class="tipue_search_content_title" href="'+found[f].url+'"'+n+">"+found[f].title+"</a>",a.debug&&(h+='<div class="tipue_search_content_debug">Score: '+found[f].score+"</div>"),a.showURL){var O=found[f].url.toLowerCase()
0==O.indexOf("http://")&&(O=O.slice(7)),h+='<div class="tipue_search_content_url"><a href="'+found[f].url+'"'+n+">"+O+"</a></div>"}if(found[f].desc){var j=found[f].desc
if(a.showContext){d=g.split(" ")
var D=found[f].desc.toLowerCase().indexOf(d[0])
if(D>a.contextStart){var S=j.substr(D-a.contextBuffer),$=S.indexOf(" ")
S=j.substr(D-a.contextBuffer+$),S=e.trim(S),S.length>a.contextLength&&(j="... "+S)}}if(p){d=g.split(" ")
for(var w=0;w<d.length;w++)if(a.highlightTerms){var B=RegExp("("+d[w]+")","gi")
j=j.replace(B,"<h0011>$1<h0012>")}}else if(a.highlightTerms){var B=RegExp("("+g+")","gi")
j=j.replace(B,'<span class="tipue_search_content_bold">$1</span>')}var U="",q=j.split(" ")
if(q.length<a.descriptiveWords)U=j
else for(var w=0;w<a.descriptiveWords;w++)U+=q[w]+" "
U=e.trim(U),"."!=U.charAt(U.length-1)&&(U+=" ..."),U=U.replace(/h0011/g,'span class="tipue_search_content_bold"'),U=U.replace(/h0012/g,"/span"),h+='<div class="tipue_search_content_text">'+U+"</div>"}}W++}if(a.showRelated&&p){w=0
for(var f=0;f<tipuesearch_related.searches.length;f++)g==tipuesearch_related.searches[f].search&&(o&&(_=g),w||(h+='<div class="tipue_search_related_title">'+tipuesearch_string_15+' <span class="tipue_search_related_bold">'+_+'</span></div><div class="tipue_search_related_cols">'),h+='<div class="tipue_search_related_text"><a class="tipue_search_related" id="'+tipuesearch_related.searches[f].related+'">',tipuesearch_related.searches[f].before&&(h+='<span class="tipue_search_related_before">'+tipuesearch_related.searches[f].before+"</span> "),h+=tipuesearch_related.searches[f].related,tipuesearch_related.searches[f].after&&(h+=' <span class="tipue_search_related_after">'+tipuesearch_related.searches[f].after+"</span>"),h+="</a></div>",w++)
w&&(h+="</div>")}if(u>a.show){var I=Math.ceil(u/a.show),Q=t/a.show
if(h+='<nav><div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',t>0&&(h+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="b" id="'+(t-a.show)+"_"+c+'">'+tipuesearch_string_6+"</a></li>"),2>=Q){var A=I
I>3&&(A=3)
for(var w=0;A>w;w++)h+=w==Q?'<li class="current" role="navigation">'+(w+1)+"</li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+w*a.show+"_"+c+'">'+(w+1)+"</a></li>"}else{var A=Q+2
A>I&&(A=I)
for(var w=Q-1;A>w;w++)h+=w==Q?'<li class="current" role="navigation">'+(w+1)+"</li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+w*a.show+"_"+c+'">'+(w+1)+"</a></li>"}Q+1!=I&&(h+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="m" id="'+(t+a.show)+"_"+c+'">'+tipuesearch_string_7+"</a></li>"),h+="</ul></div></nav>"}}else h+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else l?h+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(h+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",h+=1==a.minimumLength?'<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>":'<div id="tipue_search_warning">'+tipuesearch_string_12+" "+a.minimumLength+" "+tipuesearch_string_13+"</div>")
e("#tipue_search_content").hide().html(h).slideDown(200),e("#tipue_search_replaced").click(function(){s(0,!1)}),e(".tipue_search_related").click(function(){e("#tipue_search_input").val(e(this).attr("id")),s(0,!0)}),e(".tipue_search_foot_box").click(function(){var t=e(this).attr("id"),a=t.split("_")
s(parseInt(a[0]),a[1])})}var i={pages:[]}
e.ajaxSetup({async:!1})
var r=0
if("live"==a.mode)for(var c=0;c<tipuesearch_pages.length;c++)e.get(tipuesearch_pages[c]).done(function(t){var s=e(a.liveContent,t).text()
s=s.replace(/\s+/g," ")
var r=e(a.liveDescription,t).text()
r=r.replace(/\s+/g," ")
var n=t.toLowerCase().indexOf("<title>"),h=t.toLowerCase().indexOf("</title>",n+7)
if(-1!=n&&-1!=h)var o=t.slice(n+7,h)
else var o=tipuesearch_string_1
i.pages.push({title:o,text:r,tags:s,url:tipuesearch_pages[c]})})
"json"==a.mode&&e.getJSON(a.contentLocation).done(function(t){i=e.extend({},t)}),"static"==a.mode&&(i=e.extend({},tipuesearch))
var n=""
a.newWindow&&(n=' target="_blank"'),t("q")&&(e("#tipue_search_input").val(t("q")),s(0,!0)),e("#search_form").submit(function(e){e.preventDefault()}),e(this).keyup(function(e){"13"==e.keyCode&&s(0,!0)})})}}(jQuery)})
